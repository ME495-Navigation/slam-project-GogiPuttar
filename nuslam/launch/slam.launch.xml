<launch>

    <!-- Arguments -->
    <arg name="cmd_src" default="circle"
     description="Specifies which node publishes to the cmd_vel topic - circle, teleop, none"/>
    <arg name="robot" default="nusim"
     description="Where to launch the nodes - robot, nusim, nothing"/>
    <arg name="use_rviz" default="false"
     description="Specify if rviz needs to start - true, false"/>
  
    <!-- Argument to specify configuration file for simulator. -->
    <arg name="world_config" default="basic_world.yaml" 
    description=".yaml file to configure the world"/>

    <!-- Argument to specify configuration file for robot. -->
    <arg name="diff_config" default="diff_params.yaml" 
    description=".yaml file to configure the robot"/>
  
    <!-- Launch the Nusim simulation launch file -->
    <include file="$(find-pkg-share nuturtle_control)/launch/start_robot.launch.xml">
        <arg name="load_rviz" value="$(var use_rviz)"/>
    </include>
  
    <!-- Slam node -->
    <node pkg="nuslam" exec="slam" name="slam">
        <param from="$(find-pkg-share nuturtle_description)/config/$(var diff_config)"/>
        <param from="$(find-pkg-share nusim)/config/$(var world_config)"/>
        <remap from="/joint_states" to="blue/joint_states"/>
        <!-- Remap jsp to get wheels to rotate -->
    </node>
  
    <!-- Static transform publisher between nusim/world and map tf frames -->
    <node pkg="tf2_ros" exec="static_transform_publisher" name="nusim_world_to_map"
          args="0 0 0 0 0 0 1 /nusim/world /map"/>
  
    <!-- Declare the RViz node and load the config file-->
    <node name="rviz2" pkg="rviz2" exec="rviz2"
          args="-d $(find-pkg-share nuslam)/config/nuslam_sim.rviz" />
  
    <!-- Launch the Python launch file with the green (SLAM) robot -->
    <include file="$(find-pkg-share nuturtle_description)/launch/load_one.launch.py">
      <!-- Pass required arguments to the Python launch file -->
      <arg name="color" value="green"/>
      <arg name="use_rviz" value="false"/>
      <arg name="use_jsp" value="gui"/> 
    </include>
  
  </launch>